<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TXT Lock Mechanism</title>
</head>
<body>
<audio id="bg-audio" src="final_morse_code.m4a" type="audio/mp4" autoplay muted ></audio>
    <div class="lock-container">
        <div class="lock">
            <!-- 12 rotating letter selectors -->
            <div class="letter-selector" data-index="0"></div>
            <div class="letter-selector" data-index="1"></div>
            <div class="letter-selector" data-index="2"></div>
            <div class="letter-selector" data-index="3"></div>
            <div class="letter-selector" data-index="4"></div>
            <div class="letter-selector" data-index="5"></div>
            <div class="letter-selector" data-index="6"></div>
            <div class="letter-selector" data-index="7"></div>
            <div class="letter-selector" data-index="8"></div>
            <div class="letter-selector" data-index="9"></div>
            <div class="letter-selector" data-index="10"></div>
            <div class="letter-selector" data-index="11"></div>
        </div>
        <button id="confirm-btn">Confirm</button>
    </div>

    <!-- Pop-up -->
    <div id="popup" class="popup">
        <p id="popup-text"></p>  
        <!-- style="padding-bottom:10px;" -->
        <buttontwo id="close-popup">Try Again</buttontwo>
    </div>
    
    <!-- <div id="popupyes" class="popupyes">
        <p id="popup-text-yes"></p>
        <button id="close-popup">Keep Playing?</button>
    </div> -->

<script>
     window.addEventListener("DOMContentLoaded", () => {
    const audio = document.getElementById("bg-audio");

    // Try autoplay (some browsers allow muted autoplay)
    audio.play().catch(() => {
      console.log("Autoplay blocked, waiting for user interaction...");

      // Unmute & play after user clicks anywhere
      document.body.addEventListener("click", () => {
        audio.muted = false; // Unmute
        audio.volume = 1.0; // Set volume to max
        audio.play();
      }, { once: true }); // Run only once
    });
  });
    const correctWord = "LOVELANGUAGE"; // Change this to the correct answer
const selectors = document.querySelectorAll(".letter-selector");

// Populate letter selectors with draggable scrolling
selectors.forEach((selector, index) => {
    let letters = "♡ADEFGKLMNOPTQUVXZ".split(""); // Alphabet
    let position = 0; // Start at first letter
    selector.textContent = letters[position];

    let startY = 0;
    let isDragging = false;

    // Handle touch/mouse drag start
    selector.addEventListener("mousedown", (e) => startDrag(e));
    selector.addEventListener("touchstart", (e) => startDrag(e.touches[0]));

    function startDrag(event) {
        isDragging = true;
        startY = event.clientY || event.pageY;
    }

    // Handle dragging motion
    document.addEventListener("mousemove", (e) => moveDrag(e));
    document.addEventListener("touchmove", (e) => moveDrag(e.touches[0]));

    function moveDrag(event) {
        if (!isDragging) return;

        let deltaY = startY - (event.clientY || event.pageY);

        if (Math.abs(deltaY) > 10) { // Sensitivity threshold
            position = (position + (deltaY > 0 ? 1 : -1) + letters.length) % letters.length;
            selector.textContent = letters[position];
            startY = event.clientY || event.pageY;
        }
    }

    // Stop dragging when user releases
    document.addEventListener("mouseup", () => isDragging = false);
    document.addEventListener("touchend", () => isDragging = false);
});

// Confirm button logic
document.getElementById("confirm-btn").addEventListener("click", () => {
    let enteredWord = Array.from(selectors).map(el => el.textContent).join("");
    let popup = document.getElementById("popup");
    let popupText = document.getElementById("popup-text");
    let closePopupBtn = document.getElementById("close-popup");


    if (enteredWord === correctWord) {
        popupText.textContent = "₊˚⊹♡ Unlocking Love♡⊹˚₊";
        closePopupBtn.textContent = "Continue?";  // Change button text to "Play More"
        document.body.classList.remove("grayscale"); // Remove greyscale if correct answer
    } else {
         // Clear previous text to avoid duplication
        popupText.innerHTML = '';
        const firstLine = document.createElement("div");
        firstLine.textContent = "404"; 
        firstLine.style.marginTop = "5px"; // Apply 5px margin to the top of the "404" text
        const secondLine = document.createElement("div");
        secondLine.textContent = "Love Not Found.ᐟ"; // This is the second line.
        popupText.appendChild(secondLine); // Adds the second line.
        // popupText.style.marginTop = "5px";
        closePopupBtn.textContent = "Try Again";  // Keep button text as "Try Again"
        document.body.classList.add("grayscale"); // Apply greyscale if wrong answer
        popup.classList.remove('error-popup'); // Remove error class if any
    }

    popup.style.display = "block";
});

// Close popup and reset greyscale effect
document.getElementById("close-popup").addEventListener("click", function() {
    let closePopupBtn = document.getElementById("close-popup"); // Define the button inside the function

    if (closePopupBtn.textContent === "Continue?") {
        window.location.href = "https://ibighit.com/txt/kor/discography/"; // Redirects when unlocked
    } else {
        document.getElementById("popup").style.display = "none";
        document.body.classList.remove("grayscale"); // Reset greyscale after closing the popup
    }
});


</script>
</body>

<style>
    body {
    font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
    background-color: white;
    color: #96add6;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    flex-direction: column;
}

  /* Greyscale effect when wrong answer */
  body.grayscale {
            filter: grayscale(100%); /* Apply greyscale to entire page */
        }

/* Lock Container */
.lock-container {
    text-align: center;
}

/* Letter Selectors */
.lock {
    display: flex;
    justify-content: center;
    gap: 5px;
    /* border-style: dashed none;
    border-color: #9ab5e3; */
}

.letter-selector {
    width: 60px;
    height: 80px;
    border-style: solid none;
    border-color: #9ab5e3;
    /* background: #bad3ff; */
    color: #e85234;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 28px;
    font-weight: bold;
    cursor: grab;
    /* border-radius: 5px; */
    transition: transform 0.2s ease-out;
    user-select: none;
}

.letter-selector:active {
    cursor: grabbing;
    transform: scale(1);
}


/* Button */
button {
    font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
    margin-top: 60px;
    padding: 10px 20px;
    font-size: 24px;
    cursor: pointer;
    color:#e85234;
    background-color: white;
    border: solid;
    border-color: #9ab5e3;
    border-radius: 5px;
}

buttontwo {
    font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
    padding: 10px 20px;
    font-size: 22px;
    cursor: pointer;
    color:white;
    background-color: #e85234;
    border-color: #9ab5e3;
    letter-spacing: 1px;
    border-radius: 2px;
}

/* Popup */
.popup {
    font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
    position: fixed;
    top: 50%;
    left: 50%;
    padding-bottom: 20px;
    transform: translate(-50%, -50%);
    background: white;
    color: black;
    padding: 30px;
    border-color: #e85234;
    border-radius: 5px;
    display: none;
    text-align: center;
    width: 300px;
    height:150px;
    font-size: 28px;
    box-shadow: -6px 6px 15px 2px grey;
}

</style>
</html>
